NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M0)
      Licensed to OREGON HEALTH SCIENCES UNIVERSITY - SFA T&R, Site 70081284.
NOTE: This session is executing on the X64_7PRO  platform.



NOTE: Updated analytical products:

      SAS/STAT 12.3 (maintenance)
      SAS/ETS 12.3 (maintenance)
      SAS/OR 12.3 (maintenance)
      SAS/IML 12.3 (maintenance)
      SAS/QC 12.3 (maintenance)

NOTE: Additional host information:

 X64_7PRO WIN 6.1.7601 Service Pack 1 Workstation

NOTE: SAS initialization used:
      real time           0.65 seconds
      cpu time            0.62 seconds

1    /*==============================================================================
2    CODING CHALLENGE #1: OLS
3
4    > From: John McConnell
5    > Sent: Tuesday, December 03, 2013 9:18 AM
6    > To: Aaron Mendelson; Benjamin Chan; Hyunjee Kim; Jonah Todd-Geddes; Lorie Jacob; Margaret
6  !  Sarna-Wojcicki; Peter Graven; Ruth Rowland; Stephanie Renfro
7    > Subject: Developing programming examples for R, Stata, SAS
8    >
9    > Group
10   >
11   > Following up on our discussion last week, I propose the following exercise. I have tried
11 ! to keep this very simple. We can get more involved if we think that would help. This is a
11 ! baby step.
12   >
13   > Let's have these people take the lead:
14   >
15   > Stata -- Peter
16   > R -- Stephanie
17   > SAS -- Ben
18   >
19   > Let's work off this directory
20   > X:\OHSU Shared\Restricted\OCHSER\PROJECTS\Code_Sharing
21   > Using the file "Inpatient_Claims_Sample_1." (I have SAS, Stata, and R versions there).
22   >
23   > Please create a word document and a statistical code file (e.g., a Stata "do" file or
23 ! analog in SAS or R). The word document should describe, briefly
24   > a.    How you start the program
25   > b.    How you locate the file Inpatient_Claims_Sample_1 within your program (or perhaps
25 ! reference this in the code file).
26   > c.    How you run your code
27   > d.    How you view your results
28   >
29   > It is ok if the word file is only 4 sentences! I prefer to err on the side of keeping it
29 ! simple at this point. We can always go back and add more detail later. This is not a
29 ! manual.
30   >
31   > The code file should be commented and describe how to do the following
32   > a.    Load the dataset
33   > b.    Describe the variables that exist in the data set (i.e., print out the names of the
33 !  variables)
34   > c.    Take the mean of CLM_PMT_AMT
35   > d.    Run an OLS regression of CM_PMT_AMT  on CLM_UTLZTN_DAY_CNT and
35 ! CLM_PASS_THRU_PER_DIEM_AMT (coefficient on  CLM_UTLZTN_DAY_CNT  should be about 489 and
35 ! R-squared should be about 0.11)
36   > e.    Save the output (the coefficient estimates, standard errors, p-values) in a text
36 ! file or other file that can be opened up easily in Word or Notepad or a browser.
37   >
38   > When you're ready, send your Word doc and Code file to the group
39   >
40   > WHEN?
41   >
42   > By January 3, 2014
43   >
44   > Ben, Peter, Stephanie: let me know by the end of the week if you'd like to change this
44 ! plan (I.e., if it seems confusing, useless, or you're too busy).
45   >
46   > Also, Ben made the following observations, which I agree with -- but I thought they might
46 !  add to the complexity and so I thought we could revisit these at some point in the future,
46 !  and for now just keep it very very simple.
47   >
48   > COMMENTS FROM BEN
49   >
50   > I think it might actually be instructive to see how to get the data from CSV to a native
50 ! format for analysis (how easy/hard it is, how much can be automated, how much needs to be
50 ! programmed). That might be a big enough task just to make it the first "project".
51   >
52   > We'll want to put data on the X-drive. Probably a subfolder in the PROJECTS folder called
52 !  "CodeSharing" or something like that and further organized with the following folders
53   > 1.    Data
54   > 2.    Task01ImportingData
55   > 3.    Task02ComputingUnivariateStats
56   > 4.    Task03ModelingOLS
57   > 5.    Etc
58   ==============================================================================*/
59   title1 "Coding Challenge #1";
60
61
62   /*==============================================================================
63   Set pointer to library where the data is located.
64   Note: SAS refers to a folder or directory as a "library".
65   The "access=readonly" option isn't necessary; but it'll prevent you from accidentally
65 ! altering a dataset in the library.
66   ==============================================================================*/
67   libname lib "\\ohsum01.ohsu.edu\OHSU\OHSU Shared\Restricted\OCHSER\PROJECTS\Code_Sharing"
67 ! access=readonly;
NOTE: Libref LIB was successfully assigned as follows:
      Engine:        V9
      Physical Name: \\ohsum01.ohsu.edu\OHSU\OHSU Shared\Restricted\OCHSER\PROJECTS\Code_Sharing
68
69
70   /*==============================================================================
71   Open an HTML file to pipe all output to.
72   Use the HTMLBLUE style instead of the default; it's prettier
73   ==============================================================================*/
74   filename fHtml
74 ! "H:\CHSE\ActiveProjects\Sandbox\CodingChallenges\Challenge001\SAS\challenge001SAS.html";
75   ods html file=fHtml style=HTMLBLUE;
NOTE: Writing HTML Body file: FHTML
76   /*==============================================================================
77   Also open a text file to pipe all output to.
78   Use the SAS listing extension, *.lst
79   But this is really a text file that could be open in any text editor (e.g., Notepad,
79 ! Notepad++, Sublime, etc.)
80   The "options" statement prevents special characters from being used in the formatting of
80 ! tables; not needed if outputting only HTML, but nice if outputting to text
81   ==============================================================================*/
82   filename fLst
82 ! "H:\CHSE\ActiveProjects\Sandbox\CodingChallenges\Challenge001\SAS\challenge001SAS.lst";
83   ods listing file=fLst;
84   options formchar="|----|+|---+=|-/\<>*";
85
86
87   /*==============================================================================
88   Show the variables in the dataset Inpatient_Claims_Sample_1.sas7bdat.
89   The "order=varnum" option prints the variable list in the order they appear in the dataset.
90   Otherwise, the default is to list them alphabetically, which is sometimes less useful.
91   ==============================================================================*/
92   title2 "Exhibit 1: Data dictionary";
93   proc contents data=lib.Inpatient_Claims_Sample_1 order=varnum;
94   run;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.34 seconds
      cpu time            0.03 seconds


95
96
97   /*==============================================================================
98   Compute the mean of the clm_pmt_amt variable.
99   ==============================================================================*/
100  title2 "Exhibit 2: Summary statsitics for clm_pmt_amt variable";
101  proc means data=lib.Inpatient_Claims_Sample_1;
102      var clm_pmt_amt;
103  run;

NOTE: There were 66773 observations read from the data set LIB.INPATIENT_CLAIMS_SAMPLE_1.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           4.38 seconds
      cpu time            0.03 seconds


104
105
106  /*==============================================================================
107  Fit a least squares regression model with clm_pmt_amt as the dependent variable.
108  clm_utlztn_day_cnt and clm_pass_thru_per_diem_amt are the independent variables.
109  Output the model estimates to a dataset.
110  Use the ods statement to produce an ODS dataset of the parameter estimates
111
112  For HTML output, PROC REG defaults to produce a residual plot. For large datasets, it
112! defaults to producing a heat map instead of a scatterplot. However, the heat maps are
112! experimental as of SAS 9.4, and
113  ==============================================================================*/
114  title2 "Exhibit 3: Linear regression model";
115  proc reg data=lib.Inpatient_Claims_Sample_1;
116      model clm_pmt_amt = clm_utlztn_day_cnt clm_pass_thru_per_diem_amt;
117  run;

WARNING: Most ODS graphics with more than 5000 points have been suppressed. Use the
         PLOTS(MAXPOINTS= ) option in the PROC REG statement to change or override the cutoff.
NOTE: Heat maps are displayed instead of scatter plots when residual plots or fit plots are
      produced.
118  quit;

NOTE: PROCEDURE REG used (Total process time):
      real time           1.71 seconds
      cpu time            1.04 seconds


119
120
121  /*==============================================================================
122  Close the HTML and listing files
123  ==============================================================================*/
124  ods html close;
125  ods listing close;
